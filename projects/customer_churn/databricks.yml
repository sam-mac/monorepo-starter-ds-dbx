bundle:
  name: customer_churn

include:
  - resources/*.yml

variables:
  catalog:
    description: "Unity Catalog catalog"
  schema:
    description: "Unity Catalog schema"
  runtime_sp:
    description: "Service principal for prod run-as (application ID or name)"

permissions:
  - level: CAN_VIEW
    group_name: ds_all
  - level: CAN_RUN
    group_name: ds_team
  - level: CAN_MANAGE
    group_name: ds_platform_admins

targets:
  dev:
    default: true
    mode: development
    workspace:
      host: ${workspace.host}
      root_path: /Workspace/Users/${workspace.current_user.userName}/.bundle/${bundle.name}/${bundle.target}
      file_path: /Workspace/Users/${workspace.current_user.userName}/.vscode/${bundle.name}/${bundle.target}
    run_as:
      user_name: ${workspace.current_user.userName}
    variables:
      catalog: main_dev
      schema: customer_churn_${workspace.current_user.short_name}

  prod:
    mode: production
    workspace:
      host: ${workspace.host}
      root_path: /Workspace/Shared/.bundle/${bundle.name}/${bundle.target}
      file_path: /Workspace/Shared/.bundle/${bundle.name}/${bundle.target}
    run_as:
      service_principal_name: ${var.runtime_sp}
    variables:
      catalog: main_prod
      schema: customer_churn
